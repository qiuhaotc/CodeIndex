<Window x:Class="CodeIndex.VisualStudioExtension.Controls.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cvt="clr-namespace:CodeIndex.VisualStudioExtension.Converts"
        Title="{Binding Source={x:Static Member=cvt:LocalizationHelper.Instance}, Path=[Settings_WindowTitle]}"
        Height="640" Width="640"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}">
    <Window.Resources>
        <cvt:LocalizeConverter x:Key="LocalizeConverter"/>
    </Window.Resources>
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <GroupBox Padding="8" Margin="0 0 0 8">
            <GroupBox.Header>
                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_ServerMode"/>
            </GroupBox.Header>
            <StackPanel Orientation="Horizontal"  >
                <RadioButton Margin="0 0 20 0" IsChecked="{Binding IsRemoteMode, Mode=TwoWay}">
                    <RadioButton.Content>
                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Remote"/>
                    </RadioButton.Content>
                </RadioButton>
                <RadioButton IsChecked="{Binding IsLocalMode, Mode=TwoWay}">
                    <RadioButton.Content>
                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Local"/>
                    </RadioButton.Content>
                </RadioButton>
            </StackPanel>
        </GroupBox>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <GroupBox Padding="8" Margin="0 0 0 8">
                    <GroupBox.Header>
                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_RemoteServer"/>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Label>
                            <Label.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_RemoteServiceUrl"/>
                            </Label.Content>
                        </Label>
                        <Grid Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding RemoteServiceUrl, UpdateSourceTrigger=PropertyChanged}"/>
                            <Button Grid.Column="1" Margin="6 0 0 0" Padding="10 2" Command="{Binding OpenRemoteServiceUrlCommand}">
                                <Button.Content>
                                    <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Open"/>
                                </Button.Content>
                            </Button>
                        </Grid>
                    </Grid>
                </GroupBox>

                <GroupBox Padding="8">
                    <GroupBox.Header>
                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_LocalServer"/>
                    </GroupBox.Header>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="200"/>
                        </Grid.RowDefinitions>
                        <Label>
                            <Label.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_LocalServiceUrl"/>
                            </Label.Content>
                        </Label>
                        <TextBox Grid.Column="1" Text="{Binding LocalServiceUrl, UpdateSourceTrigger=PropertyChanged}"/>
                        <Button Grid.Column="2" Margin="6 0 0 0" Padding="10 2" Command="{Binding OpenLocalServiceUrlCommand}">
                            <Button.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Open"/>
                            </Button.Content>
                        </Button>

                        <Label Grid.Row="1">
                            <Label.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_InstallPath"/>
                            </Label.Content>
                        </Label>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding LocalServerInstallPath, UpdateSourceTrigger=PropertyChanged}"/>
                        <Button Grid.Row="1" Grid.Column="2" Margin="6 0 0 0" Padding="10 2" Command="{Binding BrowseInstallPathCommand}">
                            <Button.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Browse"/>
                            </Button.Content>
                        </Button>

                        <Label Grid.Row="2">
                            <Label.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_DataDirectory"/>
                            </Label.Content>
                        </Label>
                        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding LocalServerDataDirectory, UpdateSourceTrigger=PropertyChanged}"/>
                        <Button Grid.Row="2" Grid.Column="2" Margin="6 0 0 0" Padding="10 2" Command="{Binding BrowseDataDirCommand}">
                            <Button.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Browse"/>
                            </Button.Content>
                        </Button>

                        <Label Grid.Row="3">
                            <Label.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_InstalledVersion"/>
                            </Label.Content>
                        </Label>
                        <TextBox Grid.Row="3" Grid.Column="1" IsReadOnly="True" Text="{Binding LocalServerVersion}"/>
                        <Button Grid.Row="3" Grid.Column="2" Margin="6 0 0 0" Padding="10 2" Command="{Binding DownloadOrUpdateCommand}">
                            <Button.Content>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_DownloadUpdate"/>
                            </Button.Content>
                        </Button>

                        <StackPanel Grid.Row="4" Grid.ColumnSpan="3" Orientation="Vertical" Margin="0 8 0 4">
                            <StackPanel Orientation="Horizontal" Margin="0 0 0 4">
                                <TextBlock VerticalAlignment="Center" Margin="0 0 4 0">
                                    <TextBlock.Text>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Health"/>
                                    </TextBlock.Text>
                                </TextBlock>
                                <TextBlock Text="{Binding HealthStatus}" FontWeight="Bold"/>
                                <Button Width="60" Margin="12 0 0 0" Command="{Binding CheckHealthCommand}">
                                    <Button.Content>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Check"/>
                                    </Button.Content>
                                </Button>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0 0 0 4">
                                <Button Width="70" Margin="0 0 8 0" Command="{Binding StartServerCommand}" IsEnabled="{Binding CanStart}">
                                    <Button.Content>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Start"/>
                                    </Button.Content>
                                </Button>
                                <Button Width="70" Margin="0 0 8 0" Command="{Binding StopServerCommand}" IsEnabled="{Binding CanStop}">
                                    <Button.Content>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Stop"/>
                                    </Button.Content>
                                </Button>
                                <Button Width="70" Margin="0 0 8 0" Command="{Binding RestartServerCommand}" IsEnabled="{Binding CanRestart}">
                                    <Button.Content>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Restart"/>
                                    </Button.Content>
                                </Button>
                                <Button Width="90" Command="{Binding RefreshLogCommand}">
                                    <Button.Content>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_RefreshLog"/>
                                    </Button.Content>
                                </Button>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Margin="0 0 4 0">
                                    <TextBlock.Text>
                                        <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Download"/>
                                    </TextBlock.Text>
                                </TextBlock>
                                <ProgressBar Width="200" Height="14" Minimum="0" Maximum="100" Value="{Binding DownloadProgress}"/>
                                <TextBlock Text="{Binding DownloadProgress, StringFormat={}{0:F1}%}" Margin="6 0 0 0"/>
                            </StackPanel>
                        </StackPanel>
                        <GroupBox Grid.Row="5" Grid.ColumnSpan="3" Padding="4">
                            <GroupBox.Header>
                                <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_LatestLogLines"/>
                            </GroupBox.Header>
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBox Text="{Binding LogContent}" IsReadOnly="True" TextWrapping="NoWrap" FontFamily="Consolas" FontSize="12" Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" BorderThickness="0"/>
                            </ScrollViewer>
                        </GroupBox>
                    </Grid>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 12 0 0">
            <Button Width="100" Margin="0 0 8 0" IsDefault="True" Command="{Binding SaveCommand}">
                <Button.Content>
                    <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Save"/>
                </Button.Content>
            </Button>
            <Button Width="100" IsCancel="True">
                <Button.Content>
                    <Binding Converter="{StaticResource LocalizeConverter}" ConverterParameter="Settings_Cancel"/>
                </Button.Content>
            </Button>
        </StackPanel>
    </Grid>
</Window>